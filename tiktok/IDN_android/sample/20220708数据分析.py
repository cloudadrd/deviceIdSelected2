
df_app_info=spark.read.format("orc").load("oss://dmp-yeahmobi-com/hive_dataware/dmp/t_dmp_app_info/")

df_app_info.createTempView("df_app_info_table")
spark.sql("select * from df_app_info_table where id = 'com.ss.android.ugc.trill' ").show(500,truncate=False)
"""
+------------------------+--------------+------------+-------------+---------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+--------------+--------------------------------------------------------------------------+-----------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+------------+----------------+------------------------+----------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------+--------------------+----------------+-----------+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------+-----------------------+----------------------+------+----------------------------------------------------------------------------+------------------+-----------------+---------+---------+-----+----------+-------+
|id                      |compatible_ios|publisher_id|category_name|other_stores                                 |description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |subcategory_name       |subcategory_id|apptopia_url                                                              |category_id|offers_in_app_purchases|permissions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |privacy_url                                |category_ids|age_restrictions|cross_store_publisher_id|last_update_date|approx_size_bytes|screenshot_urls                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |icon_url                                                                                                 |initial_release_date|publisher_name  |price_cents|current_version|icons                                                                                                                                                                                                                                                                                                                                                                                               |operating_systems|vnd_estimated_installs|publisher_url          |subtitle              |name  |app_store_url                                                               |cross_store_app_id|parent_company_id|languages|bundle_id|tags |update_day|plat   |
+------------------------+--------------+------------+-------------+---------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+--------------+--------------------------------------------------------------------------+-----------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+------------+----------------+------------------------+----------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------+--------------------+----------------+-----------+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------+-----------------------+----------------------+------+----------------------------------------------------------------------------+------------------+-----------------+---------+---------+-----+----------+-------+
|com.ss.android.ugc.trill|null          |1905756     |Applications |[[store -> itunes_connect, id -> 1235601864]]|TikTok is THE destination for mobile videos. On TikTok, short-form videos are exciting, spontaneous, and genuine. Whether you’re a sports fanatic, a pet enthusiast, or just looking for a laugh, there’s something for everyone on TikTok. All you have to do is watch, engage with what you like, skip what you don’t, and you’ll find an endless stream of short videos that feel personalized just for you. From your morning coffee to your afternoon errands, TikTok has the videos that are guaranteed to make your day.<br><br>We make it easy for you to discover and create your own original videos by providing easy-to-use tools to view and capture your daily moments. Take your videos to the next level with special effects, filters, music, and more.<br><br>■ Watch endless amount of videos customized specifically for you<br>A personalized video feed based on what you watch, like, and share. TikTok offers you real, interesting, and fun videos that will make your day.<br><br>■ Explore videos, just one scroll away<br>Watch all types of videos, from Comedy, Gaming, DIY, Food, Sports, Memes, and Pets, to Oddly Satisfying, ASMR, and everything in between.<br><br>■ Pause recording multiple times in one video<br>Pause and resume your video with just a tap. Shoot as many times as you need.<br><br>■ Be entertained and inspired by a global community of creators<br>Millions of creators are on TikTok showcasing their incredible skills and everyday life. Let yourself be inspired.<br><br>■ Add your favorite music or sound to your videos for free<br>Easily edit your videos with millions of free music clips and sounds. We curate music and sound playlists for you with the hottest tracks in every genre, including Hip Hop, Edm, Pop, Rock, Rap, and Country, and the most viral original sounds.<br><br>■ Express yourself with creative effects<br>Unlock tons of filters, effects, and AR objects to take your videos to the next level.<br><br>■ Edit your own videos<br>Our integrated editing tools allow you to easily trim, cut, merge and duplicate video clips without leaving the app.<br><br>* Any feedback? Contact us at https://www.tiktok.com/legal/report/feedback or tweet us @tiktok_us|Video Players & Editors|103           |https://apptopia.com/google-play/app/com.ss.android.ugc.trill/intelligence|39         |true                   |[precise location (GPS and network-based), take pictures and videos, modify or delete the contents of your USB storage, read the contents of your USB storage, view Wi-Fi connections, read your contacts, retrieve running apps, read calendar events plus confidential information, add or modify calendar events and send email to guests without owners' knowledge, record audio, create accounts and set passwords, set wallpaper, toggle sync on and off, install shortcuts, control flashlight, pair with Bluetooth devices, control vibration, full network access, uninstall shortcuts, prevent device from sleeping, run at startup, change your audio settings, view network connections, reorder running apps, read Home settings and shortcuts, receive data from Internet]|https://www.tiktok.com/legal/privacy-policy|[39, 103]   |Teen            |8090309051              |2022-01-18      |97517568         |[https://play-lh.googleusercontent.com/nTGPbQcNQZDDZMtaRIWqWz-bLcPB71WZd6BJpgeZCsOfuqymVfwarnJFqOzFMY_p0b0, https://play-lh.googleusercontent.com/wHk9HZ7C1QtqS3bCOEMro4RuT43qOg4W8353bjb3fnD1bXVMIDDAUUG0GObrp0Ypc7o, https://play-lh.googleusercontent.com/BuprZwckxZ4wvh8FU2AP-8HuObGcrm_H-reIOKe-4WPh-eH3EPM4S8RzkcDCQEyFlE0, https://play-lh.googleusercontent.com/1YlGNlOW59fFfRi0P08YhUwY2ije0DwGPrCJiOKIEeXg-VPCrHm98722yo_HsHycMjo, https://play-lh.googleusercontent.com/AMsLvVVO_bG759TrsSQG_R43Bbyet3uYj6dX4JuLw4rwQVnVFj-PeLAI2VEkyd7anIs, https://play-lh.googleusercontent.com/pp7P_oUV4MlVpBCKjwT0_lHF4Pw3EB9SK-pzDZjelx8LdPRtWE4zFxdYiFgjXv7XfwY, https://play-lh.googleusercontent.com/YzzvGPMwjfwabhwMn7xnKCwlatbVuLzT-QVSTYtYdp2bDabhPKY0guI88naZt7Hgs_39, https://play-lh.googleusercontent.com/dv3ONOMrcv8_7GT7kVcdo_4tuJDAvoEIh1LAOK2oaB7f--dbHXCFxIUNXm6PckcBEUo, https://play-lh.googleusercontent.com/LnjPrWWTzH_gNoZdKYUakJnEHrqIIWruTjVl5h97bkkM8781dcPEEuxwofN8wzVRINI, https://play-lh.googleusercontent.com/sAqF9eqjcnQ_iELHlh4Xse1eHB1oB5vbqWIV6Brpk6SdkduMeWvtabh-z_bZK4dVjw, https://play-lh.googleusercontent.com/bXZrmqkjtwbuhxxrwr7YEsyXtW0Ek0M-ycfTE8H0pIfzQikW6udKay5iVe63adfPb_o, https://play-lh.googleusercontent.com/TH0eZbqJPtZ1-71o3t7kx87RfBj_xc05rpEphlw612SpREAJbNDo8MC1x24NQ6XoQ-1m, https://play-lh.googleusercontent.com/HVjGVN6B9XGjAcuKz-enGw8kJnoK7Wo_shTJcZr_Q0DDMpCNArzHI3xba9rybfaRfBU, https://play-lh.googleusercontent.com/EcIBHQHFV2ls9ORC6yHdbwXpQIxMS31GbF9Hvdr_bord9ffJ0pZOYJNHrtPKqJGWAw, https://play-lh.googleusercontent.com/eKJj6gimUTbxV8Uow8wnjN-PYwrMD28McNlVLvtx1jvi1kRL7n-dcQpge04MjeiP4sM, https://play-lh.googleusercontent.com/BpMybp7-RJSPKagionTKPKPIVi2mM6eyUrZv4v7yZdqtUx-cuK6G3YRApg-eD3G-YA]|https://play-lh.googleusercontent.com/2kdv4gGWKchMkThhxMYlWlkSouhx6BP50X1b7O7_Yl78fFCitAe3t4hLACuCyC9tsJA|2017-05-12          |TikTok Pte. Ltd.|null       |22.8.4         |[128x128 -> https://d1nxzqpcg2bym0.cloudfront.net/google_play/com.ss.android.ugc.trill/646aaa08-a5c8-11eb-a5d5-370d75dd53f1/128x128, 32x32 -> https://d1nxzqpcg2bym0.cloudfront.net/google_play/com.ss.android.ugc.trill/646aaa08-a5c8-11eb-a5d5-370d75dd53f1/32x32, 64x64 -> https://d1nxzqpcg2bym0.cloudfront.net/google_play/com.ss.android.ugc.trill/646aaa08-a5c8-11eb-a5d5-370d75dd53f1/64x64]|4.4 and up       |100,000,000+          |https://www.tiktok.com/|global video community|TikTok|https://play.google.com/store/apps/details?id=com.ss.android.ugc.trill&hl=en|8084050804        |8081024370       |null     |null     |[104]|20220509  |android|
+------------------------+--------------+------------+-------------+---------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+--------------+--------------------------------------------------------------------------+-----------+-----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------+------------+----------------+------------------------+----------------+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------+--------------------+----------------+-----------+---------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------+----------------------+-----------------------+----------------------+------+----------------------------------------------------------------------------+------------------+-----------------+---------+---------+-----+----------+-------+
"""
spark.sql("select id from df_app_info_table where subcategory_name='Video Players & Editors' ").show(500,truncate=False)
"""
+----------------------------------------------------------------------------------------------------------------------+
|id                                                                                                                    |
+----------------------------------------------------------------------------------------------------------------------+
|Cam_P.SILENT                                                                                                          |
|a.m.SecuGuard                                                                                                         |
|ab.video.compressor.fast.app                                                                                          |
|act.app.snsdownloader                                                                                                 |
|ad.kgac.videomaker.friendship                                                                                         |
|aegod.hearteffect.heartanimation.photoanimation                                                                       |
|aexp.explist3                                                                                                         |
|after.effects.video                                                                                                   |
|aghani.ramsaad.insaaay                                                                                                |
|ah.apps.fastfbvideodownloader.downloaderforfb                                                                         |
|air.VerticalHoritzontal                                                                                               |
|air.bpm                                                                                                               |
|air.com.logosware.gigacast.ondemand                                                                                   |
|alex.chapman.hdvideoplayer.smarthdvideos.allhdvideo                                                                   |
|alex.chapman.hdvideoplayer.smarthdvideos.newvideoplayerhd                                                             |
|ali.alhadidi.gif_facebook                                                                                             |
|alkaicer.iptv2                                                                                                        |
|all.download.free.videodownloader                                                                                     |
|all.inone.video.downloader.app                                                                                        |
|all.video.convert.any.format                                                                                          |
|all.video.downloader.app.allvideodownloaderapp                                                                        |
|all.videodownloader.all.downloader                                                                                    |
|all.videos.downloader.pro.free.movies.stream                                                                          |
|allformat.max.videoplayer.queen                                                                                       |
|allinone.video.downloader                                                                                             |
|allvideodownloader.freevideodownloader                                                                                |
|allvideoplayer.vidmahdvideo.realvidmateappplay                                                                        |
|altasec.android.VSViewerPro2.new                                                                                      |
|amazing.sad.lyricalvideostatusmaker                                                                                   |
|amer.alomari.ArabicVideoSubtitleGenerator                                                                             |
|amitechnologies.products.apps.immersiveaudioplayer                                                                    |
|amo.castie.app                                                                                                        |
|amobile.photo.video.maker                                                                                             |
|amr3.all.video.downloader.hdapp                                                                                       |
|an.islamtv                                                                                                            |
|androtechdevelopers.videoplayer.xvideoplayer                                                                          |
|angle.vidcutter.lite                                                                                                  |
|animation.independencedayslideshow                                                                                    |
|animation.independencevideomaker                                                                                      |
|animation.lovephotovideomaker                                                                                         |
|animationeffect.videomaker.animationphotoeffect.photoanimation.particle.ly.videostatusmaker.photovideomaker           |
|annie.enjoy.view.cion                                                                                                 |
|any.video.convert.all.formats                                                                                         |
|anyvideo.reelplayer.hdplayer.statusplay                                                                               |
|ap589263.hwr                                                                                                          |
|apkappstudio.imagetovideomaker                                                                                        |
|apktosdcard.com.apkinstaller.apkasd                                                                                   |
|apli1387996.kyc                                                                                                       |
|app.balint.glitchcam.maker                                                                                            |
|app.club.hdvideoplayer                                                                                                |
|app.com.balint.watercamera                                                                                            |
|app.cosmemob.novelas                                                                                                  |
|app.flvto.player                                                                                                      |
|app.greenmango.radhakrishnavanistarbharat                                                                             |
|app.hexel.stabilize_video                                                                                             |
|app.jointwo.vids                                                                                                      |
|app.joy.tiktoevideoplayer                                                                                             |
|app.kralfilmler.net                                                                                                   |
|app.luxuriya.janmastamiphotoframe                                                                                     |
|app.maxvideo.hd.videoplayer                                                                                           |
|app.onfireapps.videotrimerandjoiner                                                                                   |
|app.slideshow.filmmaker                                                                                               |
|app.smartmobile.videostatus                                                                                           |
|app.soft.music.ultra4khd.hdvideoplayer                                                                                |
|app.solvent.droptok                                                                                                   |
|app.spider.com                                                                                                        |
|app.srimox.com                                                                                                        |
|app.street.v.easyfree                                                                                                 |
|app.variouty.hdmxplayer                                                                                               |
|app.video.ben                                                                                                         |
|app.video.downloader.videodownloaderforinstagram                                                                      |
|app.video_maker.photo.song                                                                                            |
|app.work.gifmaker                                                                                                     |
|app2.aplicywo                                                                                                         |
|app2020.aplibbx                                                                                                       |
|appcreation.saxvideoplayer.hdvideoplayer                                                                              |
|appcreratorstudio.funnyvideos                                                                                         |
|appertoltd.videoeditor.videorama                                                                                      |
|appganesha.vidmkrskel                                                                                                 |
|appinventor.ai_SleddLine.KodiGuide2                                                                                   |
|appinventor.ai_giorgos_athanasiou.DB_Control_v1_3                                                                     |
|appinventor.ai_marwankurniawan2016.youmate                                                                            |
|applab.allhd.video.mp4player.ultrahd.allvideoplayer                                                                   |
|application.master.videojodnewalaapp.com                                                                              |
|application.master.videomeseringtone.com                                                                              |
|apps.diniya.halat_diniyat                                                                                             |
|apps.envision.videostreams                                                                                            |
|apps.halatwats.halat                                                                                                  |
|apps.halexo.videoeditor.photo                                                                                         |
|apps.halexo.videomaker.christmas                                                                                      |
|apps.isalmic_halat.video_islamic                                                                                      |
|apps.ombaral.photoslide                                                                                               |
|apps.shelatt.halatshelatt                                                                                             |
|apps.ta9s.halat_love                                                                                                  |
|apps.uplix.Kaleo                                                                                                      |
|appsstudio.republicdaymoviemaker                                                                                      |
|appvid.alplayer.maxapp                                                                                                |
|appwala.app.photovideomaker                                                                                           |
|appzone.newyearlivewallpaper                                                                                          |
|apva.friendship.vidmaker                                                                                              |
|ar.com.lrusso.camera.gallery                                                                                          |
|ar.televisiones.en.vivo.argentina                                                                                     |
|aratechies.fastvideodownloader.videodownloaderforfacebook                                                             |
|arewa.mopro2021                                                                                                       |
|arshp.hd.video.player                                                                                                 |
|arsia.videotube.blockads.vancedpure                                                                                   |
|audicuter.withvideocut.appmusic                                                                                       |
|audio.video.mixer.video.editor                                                                                        |
|autoandshare.headvr                                                                                                   |
|avelon.video.player.onelovevideomaker                                                                                 |
|baxley.phototooldsonglyrical.videostatusmaker                                                                         |
|bc.gn.all.format.videoplayer                                                                                          |
|bc.gn.diwali.videomaker                                                                                               |
|bc.gn.video.mixer                                                                                                     |
|be.liv.wonplayer                                                                                                      |
|be.timmichels.audiovisualizer                                                                                         |
|beauty.cam.eiduladha.video.music                                                                                      |
|bengali.birthday.videomaker                                                                                           |
|best.all.video.downloader                                                                                             |
|best.free.apps.studio.videomaker.birthdayvideomacker                                                                  |
|bestapp.videoeditor                                                                                                   |
|besttvps.com                                                                                                          |
|bestvideoeditor.videoeditorapp.videoeditor                                                                            |
|bgeditor.hdvideoplayer                                                                                                |
|bhav.bvn.videosplitter                                                                                                |
|big.joker.slowmovideomaker                                                                                            |
|binungandroid.Minimalis.Home.Designs                                                                                  |
|birthdayvidmaker.lyricalvideomaker.videomkr                                                                           |
|bitcode.pakistan.hatchful                                                                                             |
|black.newyear.moviemaker                                                                                              |
|black.videoto.mp3                                                                                                     |
|bluechip.vidmax.vplayer                                                                                               |
|bluemc.cinema.cinemablue                                                                                              |
|booom.app.sx.player                                                                                                   |
|borama.co.zoomplayer                                                                                                  |
|br.com.aplicativosejogos.videosnatal                                                                                  |
|br.com.as2.videoeditor.love                                                                                           |
|br.com.eduvm.evm3umanager.ads                                                                                         |
|br.com.indiecine.indiecine                                                                                            |
|brinfotech.videomaker                                                                                                 |
|by.likee.downloader.without.watermark                                                                                 |
|bzire.canny.mp                                                                                                        |
|c.fapassstudio.chamkilaandamarjotsongs                                                                                |
|c.fapassstudio.sadabaharoldhindisongs                                                                                 |
|c.fapassstudio.shaktimaanthesuperhero                                                                                 |
|ca.frozen.rpicameraviewer                                                                                             |
|ca.likeable.videos.toyorbaby                                                                                          |
|callername.tiktikindia.videoplayer.hdvideoplayer                                                                      |
|callhistory.videocallrecorder                                                                                         |
|canais.detv20copy                                                                                                     |
|canales.dominicanos.en.vivo.com                                                                                       |
|cancao.nova.aovivo                                                                                                    |
|candycorp.videoplayer.sxhdvideoplayer                                                                                 |
|candycorpinc.videocallchat                                                                                            |
|canli.tv.izleturkcanlitv                                                                                              |
|canlitvizlehdmobil.canlitv                                                                                            |
|canlitvizlesene.tv                                                                                                    |
|cast.screenmirroring.casttvapp.screencast                                                                             |
|cc.flashtorrent.downloader                                                                                            |
|cc.openframeworks.androidOpenCVExample                                                                                |
|ccm.gospel.misook                                                                                                     |
|cf.charly1811.android.charlyvideoplayer                                                                               |
|ch.hdmovievideoplayerfreedownload                                                                                     |
|ch.ideenverkauf.zeitmaschine                                                                                          |
|ch.rsi.player                                                                                                         |
|ch.swissinfo.player                                                                                                   |
|change.videobackground.music.replace                                                                                  |
|chinese.movies.frees                                                                                                  |
|christmas.video.maker                                                                                                 |
|cj.wc                                                                                                                 |
|click.birthdaymovie                                                                                                   |
|click.videotoimages                                                                                                   |
|click.vidmovmaker                                                                                                     |
|clipz.streamclipz                                                                                                     |
|cmrlabs.video.save                                                                                                    |
|cn.cntvnews                                                                                                           |
|co.in.biospace.android.bobanandmolly.free                                                                             |
|co.in.smartudevelopers.hdvideoplayer                                                                                  |
|co.newapp.qhtv                                                                                                        |
|co.video.videoplayer                                                                                                  |
|cocktail.videoplayer.maxvideoplayer.rainvideoplayer                                                                   |
|colorflashstudio.videoplayer.saxvideoplayer.xvideoplayer                                                              |
|coloringappsolution.independencedayvideomaker                                                                         |
|com.AISystem.vedieoplayer.HD                                                                                          |
|com.Aapp.AnubavakkalviVideo                                                                                           |
|com.AbracaDabra.BhimsenJoshi                                                                                          |
|com.Adam.Israa.ouit.music.maker.video                                                                                 |
|com.Adityak.gid                                                                                                       |
|com.AinunDev.CampursariKomplitTerbaru                                                                                 |
|com.All.hd.video.player.all.format.space                                                                              |
|com.Apps4Andro.videoecutter                                                                                           |
|com.AppsSeven.FilmesOnlineTVBOX                                                                                       |
|com.Appshire.ultra.hd.videoplayer.allformat.video.player                                                              |
|com.Appskinger.Tamil_Wa_Status                                                                                        |
|com.Appslane.lyricsstatus                                                                                             |
|com.Artisma.ScreenRecorder                                                                                            |
|com.ArzakCorp.ScoobyDoo                                                                                               |
|com.AvatarifyFaceAnimator.Avatarify.AvatarifyFaceAnimatormobiletipsv                                                  |
|com.AwamiSolution.wirelessmicvideorecorder                                                                            |
|com.Awesome.Video.MarriageAnniversaryPhotosVideoMaker                                                                 |
|com.Beatubepro.mp3mp4downloader.music.downloaderpro                                                                   |
|com.BernadetteBIOSSE.MusiqueChretienneCI                                                                              |
|com.BestPhotoEditor.SlideshowMakerWithMusic                                                                           |
|com.Bestvideoo.maker                                                                                                  |
|com.BirthdaySlideshowWithMusicVideo                                                                                   |
|com.BorderLive.LightWallpapers                                                                                        |
|com.Brains.alldonloader.freedownloader                                                                                |
|com.CHSGamez.Videodownloder                                                                                           |
|com.Chronovideodownloaderallvideodownloader.videodownloader                                                           |
|com.Crazy.Lyrical.Video.Status.Maker.Photo.Video.Music                                                                |
|com.Creative.Cool.Vlog.Diary.Camera.App                                                                               |
|com.DarkPlayer.VideoPlayer2020                                                                                        |
|com.DigitalMind.TelenorBankaVodic                                                                                     |
|com.Droid.Player                                                                                                      |
|com.ELKinc.video_maker                                                                                                |
|com.Easy.Androidstudio.Ttrl                                                                                           |
|com.Equivalent_Games.Paint_Cat_in_Color_Joke                                                                          |
|com.FA.Bcookingfk                                                                                                     |
|com.FASTCARS                                                                                                          |
|com.FJLonethand.video.editor.videomaker.cutter.joiner                                                                 |
|com.FengGangApp.Maker.Video.BirthdayGreetingsVideoMaker                                                               |
|com.FessyLove.Maker.Video.HappyNewYearVideoMaker                                                                      |
|com.FishEntertainment.Birthday.photo2VideoMaker                                                                       |
|com.GizmoVR.Virtual.Reality.Videos                                                                                    |
|com.HABARI.tv                                                                                                         |
|com.HDvideoplayer.audioplayer.mediaplayer                                                                             |
|com.HalloweenVideoMakerPhotoSlideshowWithMusicPandaky                                                                 |
|com.IPTVLATINO.tv                                                                                                     |
|com.Indian.sexyvideoss                                                                                                |
|com.IndoChemist.HOUSEDUGEM                                                                                            |
|com.Inysis.HeroVR                                                                                                     |
|com.Islamic.HifjulQuranTilawatAbuRayhan                                                                               |
|com.KSTD.videomakerslideshow                                                                                          |
|com.Kinemastervideo.Kinemaster.maketiktok                                                                             |
|com.KixApps.Video.Slow.Motion.Maker                                                                                   |
|com.KowaEye                                                                                                           |
|com.LTS.NVMS7000                                                                                                      |
|com.LiaCr3ations.video.maker                                                                                          |
|com.Londev.phototovideomaker                                                                                          |
|com.MSPlaye99                                                                                                         |
|com.MahaProstudio.musicvideo.VideoMaker                                                                               |
|com.MegaPlayer                                                                                                        |
|com.MobileAppsStation.photoslideshowwithmusicvideomaker                                                               |
|com.Moonlove.PhotoToVideowithMusic                                                                                    |
|com.MovieMakerApps.VideoShow.VideoMakerFree                                                                           |
|com.Mp3Extractor.Mp4toMp3.VideoMp3Converter.songcutter                                                                |
|com.MultanOnline.AskLaftanAnlamaz                                                                                     |
|com.Mx.player.HD.videoplayer                                                                                          |
|com.NaatsnBayans.DrIsrarAhmed                                                                                         |
|com.NawayPro                                                                                                          |
|com.OFIECorp.AmazingGuideForDeadpool                                                                                  |
|com.Odialivetv.buntyfrombengal                                                                                        |
|com.Olivevideoeditor.Olivevideomaker                                                                                  |
|com.Onlinedeautshesradiofm.AntennesteiermarkAppat1                                                                    |
|com.Optinera.Optix                                                                                                    |
|com.P2PCAM.Pro                                                                                                        |
|com.PhotoSlideshowMakerWithMusicAndEffectslollipop                                                                    |
|com.Photo_Editing_Trends.doodleshape                                                                                  |
|com.Phub.Player                                                                                                       |
|com.Pipocolandia                                                                                                      |
|com.Play.it.video.Player                                                                                              |
|com.PlayeFourK.Videof                                                                                                 |
|com.PowerFoodMan.FSMPDV                                                                                               |
|com.Pro.MahaPro.videos55.videomaker                                                                                   |
|com.Procanovol.TopVMaker                                                                                              |
|com.ProjectArrow.ScreenshotRecordVideoAudio                                                                           |
|com.Prolech.P2PBLOW                                                                                                   |
|com.REC.recorder.screenrecorder.videorecorder.screenshot.gamerecorder                                                 |
|com.Saawariya.Music                                                                                                   |
|com.ScaryVideoMakerEffects.lollipop                                                                                   |
|com.Screen.Audio.Video.Recorder.Screenshot                                                                            |
|com.Sh3dapps.Video.To.MP3.Downloader                                                                                  |
|com.SlideShow.Maker                                                                                                   |
|com.Snakevideo.Snakevideoplayer.videoplayer                                                                           |
|com.SocialMedia.A1.downloader                                                                                         |
|com.SpeedPro.VideoRecord.SlowMotionReverse                                                                            |
|com.Streamingwafe.toytoymarkotoyreviewfunny                                                                           |
|com.SukaesihDeveloper.video.player                                                                                    |
|com.TJDRHDjangsaik.tube                                                                                               |
|com.TKNSolutions.VideoSlideShow.VideoMaker                                                                            |
|com.TV.StreamingMax                                                                                                   |
|com.TeLraiApps.Build5987                                                                                              |
|com.TikTok.Video.Editor                                                                                               |
|com.TikTok.VideoMakerpro                                                                                              |
|com.ToyorAlJannahNow.NowVideo16                                                                                       |
|com.ToyorAlJannahRamadansongs2016                                                                                     |
|com.UltraHDPlayer.VideoPlayerHD                                                                                       |
|com.UnicornVideoEditorPhotoSlideshowwithMusicVision                                                                   |
|com.VaRs.VRPlayerPRO                                                                                                  |
|com.ValicApps.MadMax                                                                                                  |
|com.ValicApps.MortalKombatX                                                                                           |
|com.VictorInfotech.SlowMotionVideoMakerSlowSpeed                                                                      |
|com.Video.Downloader.NO.WatermarkFREE                                                                                 |
|com.Video.PlayVideoNow                                                                                                |
|com.Video.call.recorder                                                                                               |
|com.Video1.Viva222018mo                                                                                               |
|com.VideoAppStore.VideoTrimmer                                                                                        |
|com.VideoDownloadFB                                                                                                   |
|com.VideoMakerApps.EditorVideo.EditorMovie                                                                            |
|com.VideoRecord.FastSlowMotionVideo                                                                                   |
|com.VideoStatusMaker.VideoStatus.FullScreenVideoStatus                                                                |
|com.Video_Rotate.Denteh                                                                                               |
|com.VideobirdStudio.SlowMotionVideo                                                                                   |
|com.VideobirdStudio.VBRecorderScreenRecorder                                                                          |
|com.Videolanmovieeditor.Videolanmoviemaker                                                                            |
|com.Videoleap.is.a.fun.and.powerful.video.editing.app.Combine.clips.add.text.and.artistic.effects.and.edit.videos.easy|
|com.VidzApps.naathinaat                                                                                               |
|com.Vigovideomaker.Vigovideoeditor                                                                                    |
|com.Vmx.videoaudio.player                                                                                             |
|com.Voodamdee.Maker.Video.NewYearVideoMaker                                                                           |
|com.Youfoto.VideoMasterTools                                                                                          |
|com.Yulio.YulioViewerCB                                                                                               |
|com.a2ztech.floatingtube                                                                                              |
|com.a2ztech.screenrecorder                                                                                            |
|com.a3experts.VidZone                                                                                                 |
|com.aahana.statuscutter                                                                                               |
|com.aappistaan.supermp4player                                                                                         |
|com.abboudi.layan_samih                                                                                               |
|com.abc.hanifcamp                                                                                                     |
|com.abdnasif.akhtear                                                                                                  |
|com.abdnasif.darbat                                                                                                   |
|com.abg.VRVideoPlayer                                                                                                 |
|com.abg.VRViewerCardboard                                                                                             |
|com.abido.photovideomaker                                                                                             |
|com.abs.photoslideshow.videomaker                                                                                     |
|com.absolu.video.player                                                                                               |
|com.ac.abraiptv                                                                                                       |
|com.acan.teleecole                                                                                                    |
|com.acangroup.dtv                                                                                                     |
|com.acangroup.sentv                                                                                                   |
|com.aconvert.videocuttermerger                                                                                        |
|com.activeon                                                                                                          |
|com.ad.rainpphotoframe                                                                                                |
|com.adabi.devchira                                                                                                    |
|com.addaudio.videocutter.audiovideomixer                                                                              |
|com.addaudiotovideo.changevideosong.videoeditor                                                                       |
|com.adeosun.dclmchoirministration                                                                                     |
|com.adesoftware.appmediagadgets                                                                                       |
|com.adnonstop.jane                                                                                                    |
|com.adobe.premiererush.videoeditor                                                                                    |
|com.adolf.assamesestatusandassamesetextstatus                                                                         |
|com.adonaindroidapps.ArkOfGodTv                                                                                       |
|com.adree.moviebrowser                                                                                                |
|com.aflam.plus.raeedtv                                                                                                |
|com.aflampro.byraeed                                                                                                  |
|com.agentlemanvideosongs                                                                                              |
|com.agileapps.videoeditor                                                                                             |
|com.ah.best.video.editor.pro.free                                                                                     |
|com.ahihi.slideshow.video                                                                                             |
|com.ahihi.video.profilemaker                                                                                          |
|com.ahlebaitapps.azadari                                                                                              |
|com.ahmadrosid.rtmpplayer                                                                                             |
|com.ahmed.gdor22                                                                                                      |
|com.ahranta.android.scrd.m                                                                                            |
|com.ahsmartsolution.slidehowmaker                                                                                     |
|com.aiappstudio.screenrecorder                                                                                        |
|com.aidrive.V3.philo                                                                                                  |
|com.ainundev.DjPtUna                                                                                                  |
|com.air.swiftmp                                                                                                       |
|com.airg.facedroid                                                                                                    |
|com.airhorn.sirenplus                                                                                                 |
|com.airteltvtips.airteltv.app.guide                                                                                   |
|com.airysattv.airysattviptvbox                                                                                        |
|com.aitmyanmar.mmplayer                                                                                               |
|com.aix.tube.pop                                                                                                      |
|com.akanapps.cheerfulboycartoon                                                                                       |
|com.akasa.akasaair                                                                                                    |
|com.akhtunnel.video.editor.free                                                                                       |
|com.akingi.torrent                                                                                                    |
|com.akingi.torrent2                                                                                                   |
|com.aksplayer.full.hdmaxvideo.player                                                                                  |
|com.alaqila                                                                                                           |
|com.albplayer.albx                                                                                                    |
|com.albtv.livetv                                                                                                      |
|com.albtv.shqip                                                                                                       |
|com.alcatelsoftsol.saudifreq                                                                                          |
|com.alesoft.pe                                                                                                        |
|com.alfabcsoft.dosttv                                                                                                 |
|com.alfadroid.videoplayer.ultradownloader                                                                             |
|com.alfredplayer.playtube                                                                                             |
|com.alifinnovative.InstantAutoDownloader                                                                              |
|com.alimo.watchmovies                                                                                                 |
|com.alivideo.snap.don                                                                                                 |
|com.alkos.tvshqip                                                                                                     |
|com.all.downloader.app.me                                                                                             |
|com.all.vdmt                                                                                                          |
|com.all.videos.downloader.social.media.videos.downloader                                                              |
|com.allappsstore.lovevideoeffect.loveheartvideobeautifuleffect.phototogif                                             |
|com.allappsstudio.videoplayer.mediaplayer                                                                             |
|com.alldownloader.fastvideodownloader.hdvideoplayerdownloader.ultrahdvideoplayer                                      |
|com.allfolder.allvideo.bestvideoplayer                                                                                |
|com.allformat.videoplayer.mp4hdvideo.xvideoplayer.videomaker.free.videoplayer.fullhdvideoplayer                       |
|com.allformatevideoplayer.hdvidplayer.movievideoplayer                                                                |
|com.allformathdvideoplayer.xxsaxvideoplayer                                                                           |
|com.allformatvideoplayer.playervideofullenjoyf                                                                        |
|com.allhdvideosocial.downldrthrteen                                                                                   |
|com.alliedbox.videostatusapp                                                                                          |
|com.allin1vdodownloader.instapp.morgantex                                                                             |
|com.allin1vdodownloader.instapp.morgantexx                                                                            |
|com.allinone.fullhd.allformat.videoplayer                                                                             |
|com.allinone.video.editor                                                                                             |
|com.allinone.video.hd.downloader                                                                                      |
|com.allinone.videoandmusiceditor                                                                                      |
|com.allinonedownloader.videodownloader.photodownloader                                                                |
|com.allinonevideo.downloader                                                                                          |
|com.allstatusdownloader.fastdownloader                                                                                |
|com.allvid.hddownloader                                                                                               |
|com.allvideo.converterapp                                                                                             |
|com.allvideo.downloadfreevideo                                                                                        |
|com.allvideo.freevideodownloader.xvideodownloader                                                                     |
|com.allvideodownload.freevideo.videodownloader                                                                        |
|com.allvideodownloader.snapsave.videohd4k                                                                             |
|com.allvideodownloader.vidblastpro                                                                                    |
|com.allvideodownloader.videodownloader2021                                                                            |
|com.allvideolder.downloader                                                                                           |
|com.allvideosaver.hddwnloderfiften                                                                                    |
|com.allworld.kasidstatus                                                                                              |
|com.allworld.shaltstatus                                                                                              |
|com.almyaronta.vid                                                                                                    |
|com.alpha.weddingphotovideomaker                                                                                      |
|com.alsoft.areir                                                                                                      |
|com.altaylar.hdfilmizle2025                                                                                           |
|com.altonjohn.flipagravideoeditor                                                                                     |
|com.alwaysmusic                                                                                                       |
|com.amahua.ywofnbfd                                                                                                   |
|com.aman4india.advancedtube                                                                                           |
|com.amazing.status_video_app                                                                                          |
|com.amazingsocialdwnldr.aalpdpviddownloaderl                                                                          |
|com.amdbrowse.videoDownloader                                                                                         |
|com.amgsoftsol18.tvonlinefree                                                                                         |
|com.amugh.akhtarqureshi                                                                                               |
|com.amugh.jawariasaleem                                                                                               |
|com.amugh.muhammadshakeelattari                                                                                       |
|com.amugh.nusratfatehalikhan1                                                                                         |
|com.amugh.shabeenamajida                                                                                              |
|com.anabellainc.vdodownloader                                                                                         |
|com.andover.screen.recorder                                                                                           |
|com.androapps.total.videoeditor.cutter.reverse                                                                        |
|com.androidstore.thaitv                                                                                               |
|com.androit.anime                                                                                                     |
|com.andromo.dev102374.app191557                                                                                       |
|com.andromo.dev212145.app302505                                                                                       |
|com.andromo.dev260217.app955616                                                                                       |
|com.andromo.dev272762.app411334                                                                                       |
|com.andromo.dev350134.app489794                                                                                       |
|com.andromo.dev439549.app477615                                                                                       |
|com.andromo.dev474440.app434759                                                                                       |
|com.andromo.dev490583.app456826                                                                                       |
|com.andromo.dev490583.app456828                                                                                       |
|com.andromo.dev576843.app593347                                                                                       |
|com.andromo.dev699080.app889022                                                                                       |
|com.andromo.dev796653.app919656                                                                                       |
|com.andromo.dev796653.app925287                                                                                       |
|com.andromo.dev803101.app940818                                                                                       |
|com.andromo.dev903784.app1041397                                                                                      |
|com.andronizer.videolauncher                                                                                          |
|com.andropicsa.reverse.movie.video                                                                                    |
|com.androplus.FbProVideoDownloader                                                                                    |
|com.androworld.video_editor                                                                                           |
|com.androworldPaid2022.allinonevideoeditor                                                                            |
|com.anewvideoandaudioplayer.videoplayer2020                                                                           |
|com.angesoft.mediaplayer                                                                                              |
|com.animation.video.effect                                                                                            |
|com.animationeffectstudio.hearteffectphotovideomaker                                                                  |
|com.animationeffectstudio.photoeffectanimationvideomaker                                                              |
|com.animationeffectvideo.animationeffectvideomaker                                                                    |
|com.animationmaker.photoeffectmaker                                                                                   |
|com.animationtexts.videosintros                                                                                       |
|com.animatorexpo.android                                                                                              |
|com.animeffect.lovevideomakerwithphotoanimation                                                                       |
|com.anniversaryvideomaker.love.hearteffect.slideshow                                                                  |
|com.anniversaryvideomakerjb.videomaker                                                                                |
|com.annividmaker.anniversaryvideomaker                                                                                |
|com.annividmaker.lovephotoeffectvideomaker                                                                            |
|com.announcapp.sixtyeight.ro.videoplayer                                                                              |
|com.antropos.bathroomflooringtileideas                                                                                |
|com.anvi.thinkintruedemos                                                                                             |
|com.anvidev.hd.tiktok.videodownloader                                                                                 |
|com.any.all.video.downloader                                                                                          |
|com.anymedia.downloader.free                                                                                          |
|com.anynameapp.app11                                                                                                  |
|com.apco.hdmediaplayer                                                                                                |
|com.apensueno.hacervideosconmusicayfotosyefectosguide                                                                 |
|com.app.DesiAsianGirlsBlueFilm                                                                                        |
|com.app.XOgram                                                                                                        |
|com.app.albatvsq                                                                                                      |
|com.app.artitv                                                                                                        |
|com.app.bansalnews                                                                                                    |
|com.app.book.whats.android4                                                                                           |
|com.app.brazil_live_tv                                                                                                |
|com.app.duvarkagitlari                                                                                                |
|com.app.greenapp.imagetovideomaker                                                                                    |
|com.app.greensacrenkinemaster                                                                                         |
|com.app.hashtechstudio                                                                                                |
|com.app.likee.video.downloader.nowatermark                                                                            |
|com.app.nevrextv                                                                                                      |
|com.app.ourvideosnp                                                                                                   |
|com.app.panoramafood                                                                                                  |
|com.app.player.lts                                                                                                    |
|com.app.roadeednew                                                                                                    |
+----------------------------------------------------------------------------------------------------------------------+
"""


df=spark.read.format("orc").load("oss://sdkemr-yeahmobi/user/chensheng/pkg/tiktok/IDN_android/sample_ana/20220708_delay_2/")
df.createTempView("df_table")
spark.sql("desc df_table").show(100,truncate=False)
"""
+----------------------+-------------+-------+
|col_name              |data_type    |comment|
+----------------------+-------------+-------+
|device_id             |string       |null   |
|osversion             |string       |null   |
|lastactiveday         |string       |null   |
|activedays            |array<int>   |null   |
|lastdaygap_label      |int          |null   |
|bundles_size_label    |int          |null   |
|now_label             |int          |null   |
|now_app_set_size      |int          |null   |
|now_target_app_label  |string       |null   |
|after_label           |int          |null   |
|after_app_set_size    |int          |null   |
|after_target_app_label|string       |null   |
|activeday_label_1_cnt |bigint       |null   |
|activeday_label_2_cnt |bigint       |null   |
|activeday_label_3_cnt |bigint       |null   |
|activeday_label_4_cnt |bigint       |null   |
|activeday_label_5_cnt |bigint       |null   |
|activeday_label_6_cnt |bigint       |null   |
|activeday_label_7_cnt |bigint       |null   |
|activeday_label_8_cnt |bigint       |null   |
|activeday_label_9_cnt |bigint       |null   |
|activeday_label_10_cnt|bigint       |null   |
|activeday_label_11_cnt|bigint       |null   |
|activeday_label_12_cnt|bigint       |null   |
|activeday_label_13_cnt|bigint       |null   |
|activeday_label_14_cnt|bigint       |null   |
|activeday_label_15_cnt|bigint       |null   |
|activeday_label_16_cnt|bigint       |null   |
|activeday_label_17_cnt|bigint       |null   |
|activeday_label_18_cnt|bigint       |null   |
|activeday_label_19_cnt|bigint       |null   |
|activeday_label_20_cnt|bigint       |null   |
|activeday_label_21_cnt|bigint       |null   |
|activeday_label_22_cnt|bigint       |null   |
|activeday_label_23_cnt|bigint       |null   |
|activeday_label_24_cnt|bigint       |null   |
|activeday_label_25_cnt|bigint       |null   |
|activeday_label_26_cnt|bigint       |null   |
|activeday_label_27_cnt|bigint       |null   |
|activeday_label_28_cnt|bigint       |null   |
|activeday_label_29_cnt|bigint       |null   |
|activeday_label_30_cnt|bigint       |null   |
|activeday_label_1_01  |int          |null   |
|activeday_label_2_01  |int          |null   |
|activeday_label_3_01  |int          |null   |
|activeday_label_4_01  |int          |null   |
|activeday_label_5_01  |int          |null   |
|activeday_label_6_01  |int          |null   |
|activeday_label_7_01  |int          |null   |
|activeday_label_8_01  |int          |null   |
|activeday_label_9_01  |int          |null   |
|activeday_label_10_01 |int          |null   |
|activeday_label_11_01 |int          |null   |
|activeday_label_12_01 |int          |null   |
|activeday_label_13_01 |int          |null   |
|activeday_label_14_01 |int          |null   |
|activeday_label_15_01 |int          |null   |
|activeday_label_16_01 |int          |null   |
|activeday_label_17_01 |int          |null   |
|activeday_label_18_01 |int          |null   |
|activeday_label_19_01 |int          |null   |
|activeday_label_20_01 |int          |null   |
|activeday_label_21_01 |int          |null   |
|activeday_label_22_01 |int          |null   |
|activeday_label_23_01 |int          |null   |
|activeday_label_24_01 |int          |null   |
|activeday_label_25_01 |int          |null   |
|activeday_label_26_01 |int          |null   |
|activeday_label_27_01 |int          |null   |
|activeday_label_28_01 |int          |null   |
|activeday_label_29_01 |int          |null   |
|activeday_label_30_01 |int          |null   |
|after_app_set         |array<string>|null   |
|now_app_set           |array<string>|null   |
+----------------------+-------------+-------+
"""
spark.sql("select now_label,after_label,count(device_id) as device_id_cnt from df_table group by now_label,after_label order by device_id_cnt desc").show(100,truncate=False)
"""
+---------+-----------+-------------+                                           
|now_label|after_label|device_id_cnt|
+---------+-----------+-------------+
|0        |0          |174888842    |
|1        |1          |2484395      |
|0        |1          |37265        |
|1        |0          |10062        |
+---------+-----------+-------------+
"""

spark.sql(" \
select  \
    app \
    ,count(device_id) as device_id_cnt  \
from    \
(   \
    select  \
        device_id   \
        ,app    \
    from    \
    (   \
        select  \
            *   \
        from    \
            df_table    \
        where   \
            now_label=0 \
            and after_label=1   \
    )t1 \
    lateral view    \
        explode(after_app_set) as app   \
)t2 \
group by    \
    app \
order by    \
    device_id_cnt desc").show(100,truncate=False)
"""
+---------------------------------------------------------------------------------------+-------------+
|app                                                                                    |device_id_cnt|
+---------------------------------------------------------------------------------------+-------------+
|com.ss.android.ugc.trill                                                               |37265        |
|com.kwai.bulldog                                                                       |2301         |
|com.playit.videoplayer                                                                 |1493         |
|com.quantum.videoplayer                                                                |672          |
|com.quantum.vmplayer                                                                   |662          |
|vinkle.video.editor                                                                    |534          |
|com.lemon.lvoverseas                                                                   |301          |
|com.nexstreaming.app.kinemasterfree                                                    |266          |
|com.tempo.video.edit                                                                   |246          |
|com.mxtech.videoplayer.ad                                                              |219          |
|com.camerasideas.trimmer                                                               |195          |
|videoeditor.videorecorder.screenrecorder                                               |193          |
|instasaver.instagram.video.downloader.photo                                            |177          |
|ins.story.unfold                                                                       |160          |
|free.tube.premium.advanced.tuber                                                       |158          |
|com.cashtube.ay                                                                        |151          |
|com.coloros.video                                                                      |115          |
|com.popularapp.videodownloaderforinstagram                                             |109          |
|com.quvideo.xiaoying                                                                   |98           |
|vidma.screenrecorder.videorecorder.videoeditor.pro                                     |84           |
|com.biomes.vanced                                                                      |83           |
|facebook.video.downloader.savefrom.fb                                                  |81           |
|glitchvideoeditor.videoeffects.glitchvideoeffect                                       |80           |
|mobisocial.arcade                                                                      |78           |
|com.picslab.neon.editor                                                                |75           |
|com.story.saver.instagram.video.downloader.repost                                      |72           |
|com.video.editor.greattalent                                                           |72           |
|video.player.videoplayer                                                               |66           |
|free.video.downloader.freevideodownloader                                              |65           |
|instake.repost.instagramphotodownloader.instagramvideodownloader                       |64           |
|tiktok.video.downloader.nowatermark.tiktokdownload                                     |53           |
|screenrecorder.recorder.editor                                                         |52           |
|all.video.downloader.allvideodownloader                                                |52           |
|com.alightcreative.motion                                                              |49           |
|com.instagram.video.downloader.story.saver.photo.downloader.videodownload.photodownload|48           |
|downloader.video.download.free                                                         |45           |
|videoeditor.videomaker.videoeditorforyoutube                                           |44           |
|mp3videoconverter.videotomp3.videotomp3converter                                       |43           |
|com.videohunt.like.app.me                                                              |42           |
|com.idea.videocompress                                                                 |40           |
|com.smartapps.videodownloaderfortiktok                                                 |37           |
|com.thinkyeah.galleryvault                                                             |36           |
|videodownloader.fbvideodownloader.facebookvideodownloader.videodownloaderforfacebook   |34           |
|com.vidmix.music.maker                                                                 |34           |
|com.frontrow.vlog                                                                      |34           |
|com.xvideostudio.videoeditor                                                           |34           |
|videoplayer.videodownloader.hdvideoplayer                                              |31           |
|ins.mate.instagram.downloader.repost.hashtag.multiple                                  |31           |
|com.pandavideocompressor                                                               |30           |
|com.xvideostudio.videocompress                                                         |28           |
|com.cyberlink.powerdirector.DRA140225_01                                               |27           |
|com.funcamerastudio.videomaker                                                         |27           |
|com.videodownloader.instagram.video.downloader                                         |27           |
|com.xvideostudio.videodownload                                                         |27           |
|tmate.tiktokvideodownloader.nowatermark.savetiktokvideo                                |26           |
|video.downloader.videodownloader                                                       |26           |
|com.videomaker.photovideo                                                              |25           |
|free.files.downloader.save.video.manager                                               |25           |
|music.video.photo.slideshow.maker                                                      |25           |
|com.vid007.videobuddy                                                                  |24           |
|com.recorder.music.bstech.videoplayer                                                  |23           |
|com.znstudio.instadownload                                                             |23           |
|beatly.lite.tiktok                                                                     |22           |
|com.ai.face.play                                                                       |22           |
|com.hecorat.screenrecorder.free                                                        |22           |
|com.musicvideomaker.slideshow                                                          |19           |
|free.video.downloader.instagram.instake                                                |19           |
|com.comoon.videoplayer.xnxvideoplayer.allformat.videoplayer                            |19           |
|com.vaultmicro.camerafi.live                                                           |19           |
|com.downloadvideo.videodownloadfree21                                                  |18           |
|com.bigtvgo.playerx                                                                    |17           |
|com.utorrent.client                                                                    |16           |
|com.hld.anzenbokusucal                                                                 |15           |
|free.online.hd.video.player                                                            |15           |
|instagram.downloader.download.videos.photos                                            |15           |
|com.yoosee                                                                             |15           |
|storysaverforinstagram.storydownloader.instastorysaver                                 |15           |
|com.rocks.music.videoplayer                                                            |15           |
|com.beautyvideo.photovideomaker.videoshow                                              |14           |
|com.dlvideo.downloader.android                                                         |14           |
|com.movisoftnew.videoeditor                                                            |14           |
|videoslideshow.photoedit.videocutter                                                   |14           |
|freemusic.player                                                                       |14           |
|com.mobile.bizo.reverse                                                                |14           |
|vidma.screenrecorder.videorecorder.videoeditor.lite                                    |14           |
|com.media.music.videomaker.slideshow                                                   |14           |
|instasaver.videodownloader.photodownloader.repost                                      |14           |
|com.mobile.bizo.slowmotion                                                             |13           |
|com.videoeditorpro.android                                                             |13           |
|com.gretech.gomplayerko                                                                |13           |
|com.instadownloader.instasave.igsave.ins                                               |13           |
|com.tianxingjian.screenshot                                                            |13           |
|com.h20soft.slideshow.videomaker.videoeditor                                           |13           |
|com.video.downloader.snapx                                                             |13           |
|com.xx.xxvi.xxvidownloder                                                              |12           |
|com.mediastudio.allvideodownloader.downloadvideoshd.bestdownloader                     |12           |
|com.videomaker.videoeditor.photos.music                                                |12           |
|com.danielkorgel.SmoothActionCamSlowmo                                                 |12           |
|hd.video.downloader.app.hdvideodownloaderapp                                           |11           |
|com.ryzenrise.intromaker                                                               |11           |
+---------------------------------------------------------------------------------------+-------------+
"""

spark.sql(" \
select  \
    app \
    ,count(device_id) as device_id_cnt  \
from    \
(   \
    select  \
        device_id   \
        ,app    \
    from    \
    (   \
        select  \
            *   \
        from    \
            df_table    \
        where   \
            now_label=0 \
            and after_label=0   \
    )t1 \
    lateral view    \
        explode(after_app_set) as app   \
)t2 \
group by    \
    app \
order by    \
    device_id_cnt desc").show(100,truncate=False)
"""
+---------------------------------------------------------------------------------------+-------------+
|app                                                                                    |device_id_cnt|
+---------------------------------------------------------------------------------------+-------------+
|N                                                                                      |100118207    |
|com.kwai.bulldog                                                                       |17659128     |
|com.playit.videoplayer                                                                 |13847900     |
|vinkle.video.editor                                                                    |10773827     |
|com.quantum.videoplayer                                                                |10743014     |
|com.quantum.vmplayer                                                                   |9689040      |
|com.tempo.video.edit                                                                   |6895962      |
|com.nexstreaming.app.kinemasterfree                                                    |4912096      |
|videoeditor.videorecorder.screenrecorder                                               |4571954      |
|com.lemon.lvoverseas                                                                   |4300191      |
|ins.story.unfold                                                                       |3869868      |
|instasaver.instagram.video.downloader.photo                                            |3042346      |
|com.mxtech.videoplayer.ad                                                              |2586718      |
|com.coloros.video                                                                      |2379979      |
|com.camerasideas.trimmer                                                               |2365934      |
|com.alightcreative.motion                                                              |2332209      |
|com.popularapp.videodownloaderforinstagram                                             |2188860      |
|com.smartapps.videodownloaderfortiktok                                                 |2095865      |
|com.quvideo.xiaoying                                                                   |2056680      |
|com.picslab.neon.editor                                                                |1848219      |
|tiktok.video.downloader.nowatermark.tiktokdownload                                     |1785093      |
|vidma.screenrecorder.videorecorder.videoeditor.pro                                     |1767021      |
|instake.repost.instagramphotodownloader.instagramvideodownloader                       |1743478      |
|com.story.saver.instagram.video.downloader.repost                                      |1442774      |
|screenrecorder.recorder.editor                                                         |1387588      |
|com.frontrow.vlog                                                                      |1361573      |
|glitchvideoeditor.videoeffects.glitchvideoeffect                                       |1327306      |
|mobisocial.arcade                                                                      |1092622      |
|facebook.video.downloader.savefrom.fb                                                  |1082846      |
|com.vidmix.music.maker                                                                 |1069773      |
|mp3videoconverter.videotomp3.videotomp3converter                                       |1049571      |
|com.pandavideocompressor                                                               |1039897      |
|com.instagram.video.downloader.story.saver.photo.downloader.videodownload.photodownload|1037691      |
|tmate.tiktokvideodownloader.nowatermark.savetiktokvideo                                |1020756      |
|com.video.editor.greattalent                                                           |835769       |
|videoeditor.videomaker.videoeditorforyoutube                                           |796022       |
|free.tube.premium.advanced.tuber                                                       |785449       |
|beatly.lite.tiktok                                                                     |780844       |
|com.idea.videocompress                                                                 |770637       |
|free.video.downloader.freevideodownloader                                              |768095       |
|music.video.photo.slideshow.maker                                                      |742255       |
|com.ai.face.play                                                                       |712200       |
|video.player.videoplayer                                                               |711465       |
|com.video.downloader.snapx                                                             |683741       |
|com.xvideostudio.videoeditor                                                           |663394       |
|all.video.downloader.allvideodownloader                                                |632983       |
|ins.mate.instagram.downloader.repost.hashtag.multiple                                  |626925       |
|videodownloader.fbvideodownloader.facebookvideodownloader.videodownloaderforfacebook   |615246       |
|vidma.screenrecorder.videorecorder.videoeditor.lite                                    |600915       |
|com.funcamerastudio.videomaker                                                         |571929       |
|free.video.downloader.instagram.instake                                                |554517       |
|com.cashtube.ay                                                                        |524749       |
|com.xvideostudio.videodownload                                                         |517014       |
|com.vid007.videobuddy                                                                  |510389       |
|downloader.video.download.free                                                         |501061       |
|com.xvideostudio.videocompress                                                         |499849       |
|videoslideshow.photoedit.videocutter                                                   |489251       |
|com.hecorat.screenrecorder.free                                                        |426744       |
|com.videodownloader.instagram.video.downloader                                         |418768       |
|com.cyberlink.powerdirector.DRA140225_01                                               |415554       |
|com.videohunt.like.app.me                                                              |414812       |
|app.dupavideo.wishes                                                                   |399590       |
|videoplayer.videodownloader.hdvideoplayer                                              |395039       |
|com.downloadvideotiktok.nowatermark                                                    |389647       |
|com.biomes.vanced                                                                      |387429       |
|com.tiktokdownloader.downloadnotwatermark                                              |371038       |
|com.videomaker.photovideo                                                              |369298       |
|instagram.downloader.download.videos.photos                                            |358178       |
|com.znstudio.instadownload                                                             |356402       |
|com.mobile.bizo.slowmotion                                                             |356005       |
|com.h20soft.slideshow.videomaker.videoeditor                                           |355576       |
|video.downloader.videodownloader                                                       |347598       |
|storysaverforinstagram.storydownloader.instastorysaver                                 |333909       |
|com.thinkyeah.galleryvault                                                             |295612       |
|com.vaultmicro.camerafi.live                                                           |291059       |
|com.recorder.screenrecorder.capture                                                    |277013       |
|com.hld.anzenbokusucal                                                                 |271561       |
|com.mediastudio.allvideodownloader.downloadvideoshd.bestdownloader                     |250421       |
|com.avcrbt.funimate                                                                    |248508       |
|com.danielkorgel.SmoothActionCamSlowmo                                                 |248297       |
|com.videoeditorpro.android                                                             |244889       |
|com.videodownloaderfortiktok.withoutwatermark                                          |238822       |
|com.videomaker.videoeditor.photos.music                                                |231693       |
|picaloop.vidos.motion.leap                                                             |231420       |
|com.recorder.music.bstech.videoplayer                                                  |229754       |
|com.instadownloader.instasave.igsave.ins                                               |226799       |
|editor.video.motion.fast.slow                                                          |220613       |
|snaptik.app.tiktokdownloader.nowatermark                                               |214086       |
|free.files.downloader.save.video.manager                                               |214025       |
|com.mobi.screenrecorder.durecorder                                                     |211556       |
|im.johngalt.selvi                                                                      |210001       |
|com.media.music.videomaker.slideshow                                                   |206782       |
|com.playtube.videotube.tubevideo                                                       |205232       |
|com.beautyvideo.photovideomaker.videoshow                                              |204205       |
|com.mobile.bizo.reverse                                                                |203883       |
|instasaver.videodownloader.photodownloader.repost                                      |200022       |
|snaptik.tiktokvideodownloader.savetiktokvideo.nowatermark                              |192887       |
|com.rocks.music.videoplayer                                                            |188743       |
|hd.video.downloader.app.hdvideodownloaderapp                                           |187586       |
|com.musicvideomaker.slideshow                                                          |185245       |
+---------------------------------------------------------------------------------------+-------------+
"""
spark.sql(" \
select  \
    now_app_set_size \
    ,count(device_id) as device_id_cnt  \
from    \
(   \
    select  \
        device_id   \
        ,now_app_set_size    \
    from    \
        df_table    \
    where   \
        now_label=0 \
        and after_label=1   \
)t2 \
group by    \
    now_app_set_size \
order by    \
    device_id_cnt desc").show(100,truncate=False)
"""
+----------------+-------------+                                                
|now_app_set_size|device_id_cnt|
+----------------+-------------+
|0               |30467        |
|1               |4569         |
|2               |1128         |
|3               |549          |
|4               |299          |
|5               |128          |
|6               |71           |
|7               |26           |
|8               |12           |
|9               |5            |
|12              |4            |
|10              |3            |
|14              |1            |
|22              |1            |
|11              |1            |
|16              |1            |
+----------------+-------------+
"""

spark.sql("   \
    select  \
        label_temp  \
        ,count(device_id) as device_id_cnt  \
    from    \
    (   \
        select  \
            device_id   \
            ,case   \
            when after_label=1 then 1   \
            when after_label=0 and after_app_set_size > now_app_set_size then 2 \
            else 3 end as label_temp    \
        from    \
            df_table    \
        where   \
            now_label=0 \
    )t1 \
    group by    \
        label_temp  \
    order by    \
        device_id_cnt desc  \
").show(100,truncate=False)
"""
+----------+-------------+                                                      
|label_temp|device_id_cnt|
+----------+-------------+
|3         |174388353    |
|2         |500489       |
|1         |37265        |
+----------+-------------+
"""
spark.sql(" \
    select  \
        after_app   \
        ,count(device_id) as device_id_cnt  \
    from    \
    (   \
        select  \
            t2_after.device_id  \
            ,t2_after.after_app   \
            ,now_app_set_size  \
        from    \
        (   \
            select  \
                device_id   \
                ,now_app    \
            from    \
            (   \
                select  \
                    now_app_set \
                    ,device_id  \
                from    \
                    df_table    \
                where   \
                    now_label=0 \
                    and after_label=0   \
                    and after_app_set_size > now_app_set_size   \
            )t1_now \
            lateral view    \
                explode(now_app_set) as now_app \
        )t2_now \
        right join  \
        (   \
            select  \
                device_id   \
                ,after_app  \
                ,now_app_set_size   \
            from    \
            (   \
                select  \
                    after_app_set   \
                    ,device_id  \
                    ,now_app_set_size   \
                from    \
                    df_table    \
                where   \
                    now_label=0 \
                    and after_label=0   \
                    and after_app_set_size > now_app_set_size   \
            )t1_after   \
            lateral view    \
                explode(after_app_set) as after_app   \
        )t2_after   \
        on  \
            t2_now.device_id = t2_after.device_id   \
            and t2_now.now_app = t2_after.after_app  \
        where   \
            t2_now.now_app is null  \
    )t3 \
    group by    \
        after_app   \
    order by    \
        device_id_cnt desc  \
").show(100,truncate=False)
"""
+---------------------------------------------------------------------------------------+-------------+
|after_app                                                                              |device_id_cnt|
+---------------------------------------------------------------------------------------+-------------+
|com.kwai.bulldog                                                                       |148278       |
|com.lemon.lvoverseas                                                                   |79649        |
|com.playit.videoplayer                                                                 |40102        |
|com.quantum.vmplayer                                                                   |23085        |
|tiktok.video.downloader.nowatermark.tiktokdownload                                     |13342        |
|vinkle.video.editor                                                                    |12562        |
|com.cashtube.ay                                                                        |11177        |
|com.coloros.video                                                                      |10947        |
|com.mxtech.videoplayer.ad                                                              |9040         |
|com.tempo.video.edit                                                                   |8704         |
|ins.story.unfold                                                                       |7200         |
|free.tube.premium.advanced.tuber                                                       |6572         |
|com.camerasideas.trimmer                                                               |6519         |
|com.biomes.vanced                                                                      |5755         |
|com.video.editor.greattalent                                                           |5655         |
|instasaver.instagram.video.downloader.photo                                            |4812         |
|mobisocial.arcade                                                                      |4756         |
|vidma.screenrecorder.videorecorder.videoeditor.pro                                     |4697         |
|facebook.video.downloader.savefrom.fb                                                  |4123         |
|videoeditor.videorecorder.screenrecorder                                               |4083         |
|com.snapmate.tiktokdownloadernowatermark                                               |3521         |
|com.xvideostudio.videocompress                                                         |2908         |
|com.pandavideocompressor                                                               |2878         |
|com.quantum.videoplayer                                                                |2589         |
|com.idea.videocompress                                                                 |2225         |
|com.snapig.instagramdownloader                                                         |1888         |
|screenrecorder.recorder.editor                                                         |1879         |
|free.files.downloader.save.video.manager                                               |1740         |
|vidma.screenrecorder.videorecorder.videoeditor.lite                                    |1670         |
|downloader.video.download.free                                                         |1644         |
|com.vaultmicro.camerafi.live                                                           |1577         |
|instasaver.videodownloader.photodownloader.repost                                      |1452         |
|com.hld.anzenbokusucal                                                                 |1438         |
|com.young.simple.player                                                                |1424         |
|com.comoon.videoplayer.xnxvideoplayer.allformat.videoplayer                            |1325         |
|com.musicvideomaker.slideshow                                                          |1295         |
|com.danielkorgel.SmoothActionCamSlowmo                                                 |1278         |
|com.music.slideshow.videoeditor.videomaker                                             |1266         |
|com.picslab.neon.editor                                                                |1198         |
|remove.picture.video.watermark.watermarkremove                                         |1187         |
|glitchvideoeditor.videoeffects.glitchvideoeffect                                       |1181         |
|free.video.downloader.freevideodownloader                                              |1178         |
|video.player.videoplayer                                                               |1178         |
|com.allvideodownloader.snapsave.videohd4k                                              |1149         |
|all.video.downloader.allvideodownloader                                                |1055         |
|freemusic.player                                                                       |968          |
|com.instadownloader.instasave.igsave.ins                                               |940          |
|com.hecorat.screenrecorder.free                                                        |938          |
|com.bigtvgo.playerx                                                                    |937          |
|com.proxy.videofast.downloader                                                         |844          |
|com.xvideostudio.videoeditor                                                           |800          |
|com.ezviz                                                                              |789          |
|download.video.tiktok.downloader.no.watermark.snaptik.app                              |785          |
|com.box.video.downloader                                                               |779          |
|free.xnxx.hot.video.downloader                                                         |703          |
|video.downloader.videodownloader                                                       |683          |
|com.thinkyeah.galleryvault                                                             |675          |
|ins.mate.instagram.downloader.repost.hashtag.multiple                                  |673          |
|storysaverforinstagram.storydownloaderforinstagram                                     |647          |
|com.quvideo.xiaoying                                                                   |643          |
|com.cavevideo.tiksave                                                                  |643          |
|com.tiktok.video.downloader                                                            |642          |
|com.rocks.music.videoplayer                                                            |634          |
|com.alightcreative.motion                                                              |598          |
|com.ai.face.play                                                                       |584          |
|com.yoosee                                                                             |564          |
|com.nexstreaming.app.kinemasterfree                                                    |563          |
|com.story.saver.instagram.video.downloader.repost                                      |559          |
|videoeditor.videomaker.videoeditorforyoutube                                           |550          |
|instadownloader.instagram.video.downloader.new                                         |530          |
|com.tianxingjian.screenshot                                                            |528          |
|video.downloader.instagram.ig.download.story.saver                                     |528          |
|com.funcamerastudio.videomaker                                                         |526          |
|mp3videoconverter.videotomp3.videotomp3converter                                       |526          |
|com.downloadvideoapp.freedownloadvideo5                                                |509          |
|com.free.video.downloader.fbdownloader                                                 |508          |
|com.videohunt.like.app.me                                                              |500          |
|com.recorder.music.bstech.videoplayer                                                  |488          |
|beatly.lite.tiktok                                                                     |472          |
|vidma.video.editor.videomaker                                                          |456          |
|com.pas.webcam                                                                         |447          |
|download.video.free.videodownlaoder.savevideo                                          |442          |
|repost.share.instagram.videodownloader.photodownloader                                 |439          |
|com.instagram.video.downloader.story.saver.photo.downloader.videodownload.photodownload|439          |
|com.utorrent.client                                                                    |438          |
|com.videoconverter.videocompressor                                                     |435          |
|com.video.player.hdvideo.player.smartplayer                                            |426          |
|twittervideodownloader.twitter.videoindir.savegif.twdown                               |425          |
|com.mobi.screenrecorder.durecorder                                                     |424          |
|hd.video.downloader.app.hdvideodownloaderapp                                           |418          |
|com.mediastudio.allvideodownloader.downloadvideoshd.bestdownloader                     |415          |
|com.cyberlink.powerdirector.DRA140225_01                                               |402          |
|com.videoeditorpro.android                                                             |401          |
|com.downloadvideo.videodownloadfree21                                                  |377          |
|instagram.insaver.igtv.repost                                                          |372          |
|com.popularapp.videodownloaderforinstagram                                             |369          |
|photo.and.video.collage                                                                |366          |
|com.free.video.downloader.eeopi                                                        |351          |
|com.hudun.androidwatermark                                                             |341          |
|com.snowwhiteapps.downloader                                                           |338          |
+---------------------------------------------------------------------------------------+-------------+
"""

spark.sql(" \
    select  \
        now_app_set_size   \
        ,count(device_id) as device_id_cnt  \
    from    \
    (   \
        select  \
            t2_after.device_id  \
            ,t2_after.after_app   \
            ,now_app_set_size  \
        from    \
        (   \
            select  \
                device_id   \
                ,now_app    \
            from    \
            (   \
                select  \
                    now_app_set \
                    ,device_id  \
                from    \
                    df_table    \
                where   \
                    now_label=0 \
                    and after_label=0   \
                    and after_app_set_size > now_app_set_size   \
            )t1_now \
            lateral view    \
                explode(now_app_set) as now_app \
        )t2_now \
        right join  \
        (   \
            select  \
                device_id   \
                ,after_app  \
                ,now_app_set_size   \
            from    \
            (   \
                select  \
                    after_app_set   \
                    ,device_id  \
                    ,now_app_set_size   \
                from    \
                    df_table    \
                where   \
                    now_label=0 \
                    and after_label=0   \
                    and after_app_set_size > now_app_set_size   \
            )t1_after   \
            lateral view    \
                explode(after_app_set) as after_app   \
        )t2_after   \
        on  \
            t2_now.device_id = t2_after.device_id   \
            and t2_now.now_app = t2_after.after_app  \
        where   \
            t2_now.now_app is null  \
    )t3 \
    group by    \
        now_app_set_size   \
    order by    \
        device_id_cnt desc  \
").show(100,truncate=False)

"""
+----------------+-------------+                                                
|now_app_set_size|device_id_cnt|
+----------------+-------------+
|0               |242316       |
|1               |108164       |
|2               |60557        |
|3               |38408        |
|4               |23401        |
|5               |14029        |
|6               |8612         |
|7               |5218         |
|8               |3273         |
|9               |2020         |
|10              |1264         |
|11              |842          |
|12              |583          |
|13              |415          |
|14              |265          |
|15              |180          |
|16              |136          |
|17              |101          |
|18              |80           |
|19              |68           |
|22              |46           |
|23              |39           |
|21              |35           |
|20              |33           |
|24              |23           |
|25              |22           |
|26              |19           |
|28              |14           |
|27              |13           |
|31              |9            |
|30              |7            |
|35              |6            |
|33              |6            |
|32              |5            |
|62              |4            |
|43              |4            |
|34              |4            |
|38              |3            |
|44              |3            |
|69              |3            |
|41              |3            |
|64              |3            |
|36              |3            |
|45              |2            |
|51              |2            |
|58              |2            |
|52              |2            |
|49              |2            |
|56              |2            |
|29              |2            |
|89              |1            |
|47              |1            |
|37              |1            |
|80              |1            |
|54              |1            |
|94              |1            |
|61              |1            |
|53              |1            |
|48              |1            |
|50              |1            |
|96              |1            |
|111             |1            |
|46              |1            |
|40              |1            |
+----------------+-------------+
"""